<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Index · BetaML.jl Documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">BetaML.jl Documentation</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Index</a><ul class="internal"><li><a class="tocitem" href="#Installation-1"><span>Installation</span></a></li><li><a class="tocitem" href="#Loading-the-module(s)-1"><span>Loading the module(s)</span></a></li><li><a class="tocitem" href="#Usage-1"><span>Usage</span></a></li><li><a class="tocitem" href="#Examples-1"><span>Examples</span></a></li><li><a class="tocitem" href="#Acknowledgements-1"><span>Acknowledgements</span></a></li></ul></li><li><a class="tocitem" href="Perceptron.html">Perceptron</a></li><li><a class="tocitem" href="Nn.html">Nn</a></li><li><a class="tocitem" href="Clustering.html">Clustering</a></li><li><a class="tocitem" href="Utils.html">Utils</a></li><li><a class="tocitem" href="Notebooks.html">Notebooks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sylvaticus/BetaML.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation-1"><a class="docs-heading-anchor" href="#![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation-1"><img src="assets/BetaML_logo_30x30.png" alt="BLogos"/> BetaML.jl Documentation</a><a class="docs-heading-anchor-permalink" href="#![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation-1" title="Permalink"></a></h1><p>Welcome to the documentation of the <a href="https://github.com/sylvaticus/BetaML.jl"><em>Beta Machine Learning toolkit</em></a>.</p><h2 id="Installation-1"><a class="docs-heading-anchor" href="#Installation-1">Installation</a><a class="docs-heading-anchor-permalink" href="#Installation-1" title="Permalink"></a></h2><p>The BetaML package is now included in the standard Julia register, install it with:</p><ul><li><code>] add BetaML</code></li></ul><h2 id="Loading-the-module(s)-1"><a class="docs-heading-anchor" href="#Loading-the-module(s)-1">Loading the module(s)</a><a class="docs-heading-anchor-permalink" href="#Loading-the-module(s)-1" title="Permalink"></a></h2><p>This package is split in several submodules. You can access its functionality either by <code>using</code> the specific submodule of interest and then directly the provided functionality (utilities are re-exported by each of the other submodules, so normally you don&#39;t need to implicitly import them) or by <code>using</code> the root module <code>BetaML</code> and then prefix with <code>BetaML.</code> each object/function you want to use, e.g.:</p><pre><code class="language-julia">using BetaML.Nn
myLayer = DenseLayer(2,3)</code></pre><p>or, equivalently,</p><pre><code class="language-julia">using BetaML
res = BetaML.kernelPerceptron([1.1 2.1; 5.3 4.2; 1.8 1.7], [-1,1,-1])</code></pre><h2 id="Usage-1"><a class="docs-heading-anchor" href="#Usage-1">Usage</a><a class="docs-heading-anchor-permalink" href="#Usage-1" title="Permalink"></a></h2><p>Documentation for most algorithms can be retrieved using the inline Julia help system (just press the question mark <code>?</code> and then, on the special help prompt <code>help?&gt;</code>, type the function name).</p><p>For a list of supported algorithms please look at the individual modules:</p><ul><li><a href="Perceptron.html"><strong><code>BetaML.Perceptron</code></strong></a>: Perform classification tasks using the Perceptron, Kernel Perceptron or Pegasos algorithms</li><li><a href="Nn.html"><strong><code>BetaML.Nn</code></strong></a>: Implementation of Artificial Neural Networks</li><li><a href="Clustering.html"><strong><code>BetaML.Clustering</code>`</strong></a>: Clustering algorithms (Kmeans, Mdedoids, EM/GMM) and missing imputation / collaborative filtering / recommandation systems using clusters</li><li><a href="Utils.html"><strong><code>BetaML.Utils</code>`</strong></a>: Various utility functions (scale, one-hot, distances, kernels, pca, accuracy/error measures..)</li></ul><h2 id="Examples-1"><a class="docs-heading-anchor" href="#Examples-1">Examples</a><a class="docs-heading-anchor-permalink" href="#Examples-1" title="Permalink"></a></h2><ul><li><strong>Using an Artificial Neural Network for multinomial categorisation</strong></li></ul><pre><code class="language-julia"># Load Modules
using BetaML.Nn, DelimitedFiles, Random, StatsPlots # Load the main module and ausiliary modules
Random.seed!(123); # Fix the random seed (to obtain reproducible results)

# Load the data
iris     = readdlm(joinpath(dirname(Base.find_package(&quot;BetaML&quot;)),&quot;..&quot;,&quot;test&quot;,&quot;data&quot;,&quot;iris.csv&quot;),&#39;,&#39;,skipstart=1)
iris     = iris[shuffle(axes(iris, 1)), :] # Shuffle the records, as they aren&#39;t by default
x        = convert(Array{Float64,2}, iris[:,1:4])
y        = map(x-&gt;Dict(&quot;setosa&quot; =&gt; 1, &quot;versicolor&quot; =&gt; 2, &quot;virginica&quot; =&gt;3)[x],iris[:, 5]) # Convert the target column to numbers
y_oh     = oneHotEncoder(y) # Convert to One-hot representation (e.g. 2 =&gt; [0 1 0], 3 =&gt; [0 0 1])

# Split the data in training/testing sets
ntrain    = Int64(round(size(x,1)*0.8))
xtrain    = x[1:ntrain,:]
ytrain    = y[1:ntrain]
ytrain_oh = y_oh[1:ntrain,:]
xtest     = x[ntrain+1:end,:]
ytest     = y[ntrain+1:end]

# Define the Artificial Neural Network model
l1   = DenseLayer(4,10,f=relu) # Activation function is ReLU
l2   = DenseLayer(10,3)        # Activation function is identity by default
l3   = VectorFunctionLayer(3,3,f=softMax) # Add a (parameterless) layer whose activation function (softMax in this case) is defined to all its nodes at once
mynn = buildNetwork([l1,l2,l3],squaredCost,name=&quot;Multinomial logistic regression Model Sepal&quot;) # Build the NN and use the squared cost (aka MSE) as error function

# Training it (default to ADAM)
res = train!(mynn,scale(xtrain),ytrain_oh,epochs=100,batchSize=6) # Use optAlg=SGD (Stochastic Gradient Descent) by default

# Test it
ŷtrain        = predict(mynn,scale(xtrain))   # Note the scaling function
ŷtest         = predict(mynn,scale(xtest))
trainAccuracy = accuracy(ŷtrain,ytrain,tol=1) # 0.983
testAccuracy  = accuracy(ŷtest,ytest,tol=1)   # 1.0

# Visualise results
testSize = size(ŷtest,1)
ŷtestChosen =  [argmax(ŷtest[i,:]) for i in 1:testSize]
groupedbar([ytest ŷtestChosen], label=[&quot;ytest&quot; &quot;ŷtest (est)&quot;], title=&quot;True vs estimated categories&quot;) # All records correctly labelled !
plot(0:res.epochs,res.ϵ_epochs, ylabel=&quot;epochs&quot;,xlabel=&quot;error&quot;,legend=nothing,title=&quot;Avg. error per epoch on the Sepal dataset&quot;)</code></pre><p><img src="assets/sepalOutput_results.png" alt="results"/></p><p><img src="assets/sepalOutput_errors.png" alt="results"/></p><ul><li><strong>Using the Expectation-Maximisation algorithm for clustering</strong></li></ul><pre><code class="language-julia">using BetaML.Clustering, DelimitedFiles, Random, StatsPlots # Load the main module and ausiliary modules
Random.seed!(123); # Fix the random seed (to obtain reproducible results)

# Load the data
iris     = readdlm(joinpath(dirname(Base.find_package(&quot;BetaML&quot;)),&quot;..&quot;,&quot;test&quot;,&quot;data&quot;,&quot;iris.csv&quot;),&#39;,&#39;,skipstart=1)
iris     = iris[shuffle(axes(iris, 1)), :] # Shuffle the records, as they aren&#39;t by default
x        = convert(Array{Float64,2}, iris[:,1:4])
x        = scale(x) # normalise all dimensions to (μ=0, σ=1)
y        = map(x-&gt;Dict(&quot;setosa&quot; =&gt; 1, &quot;versicolor&quot; =&gt; 2, &quot;virginica&quot; =&gt;3)[x],iris[:, 5]) # Convert the target column to numbers

# Get some ranges of minVariance and minCovariance to test
minVarRange = collect(0.04:0.05:1.5)
minCovarRange = collect(0:0.05:1.45)

# Run the em algorithm for the various cases...
sphOut  = [em(x,3,mixtures=[SphericalGaussian() for i in 1:3],minVariance=v, minCovariance=cv, verbosity=NONE) for v in minVarRange, cv in minCovarRange[1:1]]
diagOut  = [em(x,3,mixtures=[DiagonalGaussian() for i in 1:3],minVariance=v, minCovariance=cv, verbosity=NONE)  for v in minVarRange, cv in minCovarRange[1:1]]
fullOut = [em(x,3,mixtures=[FullGaussian() for i in 1:3],minVariance=v, minCovariance=cv, verbosity=NONE)  for v in minVarRange, cv in minCovarRange]

# Get the Bayesian information criterion (AIC is also available)
sphBIC = [sphOut[v,cv].BIC for v in 1:length(minVarRange), cv in 1:1]
diagBIC = [diagOut[v,cv].BIC for v in 1:length(minVarRange), cv in 1:1]
fullBIC = [fullOut[v,cv].BIC for v in 1:length(minVarRange), cv in 1:length(minCovarRange)]

# Compare the accuracy with true categories
sphAcc  = [accuracy(sphOut[v,cv].pₙₖ,y,ignoreLabels=true) for v in 1:length(minVarRange), cv in 1:1]
diagAcc = [accuracy(diagOut[v,cv].pₙₖ,y,ignoreLabels=true) for v in 1:length(minVarRange), cv in 1:1]
fullAcc = [accuracy(fullOut[v,cv].pₙₖ,y,ignoreLabels=true) for v in 1:length(minVarRange), cv in 1:length(minCovarRange)]

plot(minVarRange,[sphBIC diagBIC fullBIC[:,1] fullBIC[:,15] fullBIC[:,30]], markershape=:circle, label=[&quot;sph&quot; &quot;diag&quot; &quot;full (cov=0)&quot; &quot;full (cov=0.7)&quot; &quot;full (cov=1.45)&quot;], title=&quot;BIC&quot;, xlabel=&quot;minVariance&quot;)
plot(minVarRange,[sphAcc diagAcc fullAcc[:,1] fullAcc[:,15] fullAcc[:,30]], markershape=:circle, label=[&quot;sph&quot; &quot;diag&quot; &quot;full (cov=0)&quot; &quot;full (cov=0.7)&quot; &quot;full (cov=1.45)&quot;], title=&quot;Accuracies&quot;, xlabel=&quot;minVariance&quot;)</code></pre><p><img src="assets/sepalClustersBIC.png" alt="results"/></p><p><img src="assets/sepalClustersAccuracy.png" alt="results"/></p><ul><li><strong>Further examples</strong></li></ul><p>We also provide <a href="Notebooks.html">some Jupyter notebooks</a> that can be run online without installing anything, so you can start playing with the library in minutes.</p><h2 id="Acknowledgements-1"><a class="docs-heading-anchor" href="#Acknowledgements-1">Acknowledgements</a><a class="docs-heading-anchor-permalink" href="#Acknowledgements-1" title="Permalink"></a></h2><p>The development of this package at the <em>Bureau d&#39;Economie Théorique et Appliquée</em> (BETA, Nancy) was supported by the French National Research Agency through the <a href="http://mycor.nancy.inra.fr/ARBRE/">Laboratory of Excellence ARBRE</a>, a part of the “Investissements d&#39;Avenir” Program (ANR 11 – LABX-0002-01).</p><p><a href="hhttp://www.beta-umr7522.fr/"><img src="assets/logos_betaumr.png" alt="BLogos"/></a></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="Perceptron.html">Perceptron »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 27 July 2020 10:25">Monday 27 July 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
